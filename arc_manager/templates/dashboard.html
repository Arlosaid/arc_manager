{% extends "base.html" %}
{% load static %}

{% block title %}Dashboard - Arc Manager{% endblock %}

{% block extra_css %}
<link href="{% static 'css/dashboard.css' %}?v=15" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="dashboard-premium">
    <!-- Header simplificado con bienvenida y stats principales -->
    <header class="dashboard-header-premium">
        <div class="welcome-section">
            <div class="welcome-content">
                <div class="time-greeting">¡Bienvenido de vuelta!</div>
                <h1 class="user-name">{{ user.first_name|default:"Roberto" }} {{ user.last_name|default:"Dela" }}</h1>
                <p class="welcome-subtitle">Tienes 2 proyectos activos y 3 planos pendientes de revisión.<br/>¡Sigue adelante con tu progreso semanal!</p>
            </div>
            <div class="header-stats">
                <div class="stat-item">
                    <div class="stat-value">75%</div>
                    <div class="stat-label">Progreso General</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">2</div>
                    <div class="stat-label">Proyectos Activos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">3</div>
                    <div class="stat-label">Planos Pendientes</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Métricas principales compactas -->
    <section class="metrics-section">
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-icon"><i class="fas fa-project-diagram"></i></div>
                <div class="metric-content">
                    <div class="metric-value" data-target="{{ active_projects_count|default:2 }}">2</div>
                    <div class="metric-label">Proyectos Activos</div>
                </div>
            </div>
            <div class="metric-card">
                <div class="metric-icon"><i class="fas fa-check-double"></i></div>
                <div class="metric-content">
                    <div class="metric-value" data-target="{{ tasks_completed_week|default:5 }}">5</div>
                    <div class="metric-label">Tareas Completadas</div>
                </div>
            </div>
            <div class="metric-card">
                <div class="metric-icon"><i class="fas fa-file-upload"></i></div>
                <div class="metric-content">
                    <div class="metric-value" data-target="{{ total_documents_uploaded|default:12 }}">12</div>
                    <div class="metric-label">Documentos Técnicos</div>
                </div>
            </div>
            <div class="metric-card">
                <div class="metric-icon"><i class="fas fa-drafting-compass"></i></div>
                <div class="metric-content">
                    <div class="metric-value" data-target="{{ blueprints_reviewed|default:8 }}">8</div>
                    <div class="metric-label">Planos Revisados</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Layout principal con sidebar -->
    <div class="dashboard-main-layout">
        <!-- Área principal - Proyectos -->
        <main class="main-content">
            <!-- Proyectos Activos - Prioridad visual -->
            <section class="projects-section">
                <div class="section-header">
                    <div class="section-title">
                        <h2><i class="fas fa-building"></i> Proyectos Activos</h2>
                        <p class="section-subtitle">Gestiona tus proyectos arquitectónicos en curso</p>
                    </div>
                    <div class="section-actions">
                        <a href="#" class="btn-primary"><i class="fas fa-plus"></i> Nuevo Proyecto</a>
                        <a href="#" class="btn-secondary">Ver Todos</a>
                    </div>
                </div>
                
                <div class="projects-grid">
                    <div class="project-card-enhanced">
                        <div class="project-header">
                            <img src="https://images.unsplash.com/photo-1541888946425-d81bb19240f5?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max" alt="Torre Central" class="project-image">
                            <div class="project-status-badge in-progress">En Desarrollo</div>
                        </div>
                        <div class="project-content">
                            <h3 class="project-name">Desarrollo Torre Central</h3>
                            <p class="project-description">Complejo habitacional de 15 pisos en zona residencial</p>
                            
                            <div class="project-metrics">
                                <div class="metric-item">
                                    <span class="metric-label">Progreso</span>
                                    <div class="progress-container">
                                        <div class="progress-bar" style="width: 75%;"></div>
                                        <span class="progress-text">75%</span>
                                    </div>
                                </div>
                                <div class="project-stats">
                                    <div class="stat">
                                        <i class="fas fa-calendar-alt"></i>
                                        <span>3 meses restantes</span>
                                    </div>
                                    <div class="stat">
                                        <i class="fas fa-users"></i>
                                        <span>8 miembros</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="project-actions">
                                <a href="#" class="btn-outline">Ver Planos</a>
                                <a href="#" class="btn-outline">Especificaciones</a>
                                <a href="#" class="btn-primary-sm">Abrir Proyecto</a>
                            </div>
                        </div>
                    </div>

                    <div class="project-card-enhanced">
                        <div class="project-header">
                            <img src="https://images.unsplash.com/photo-1487958449943-2429e8be8625?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max" alt="Oficinas Corporativas" class="project-image">
                            <div class="project-status-badge completed">Finalizado</div>
                        </div>
                        <div class="project-content">
                            <h3 class="project-name">Remodelación Oficinas</h3>
                            <p class="project-description">Renovación integral de espacios corporativos modernos</p>
                            
                            <div class="project-metrics">
                                <div class="metric-item">
                                    <span class="metric-label">Progreso</span>
                                    <div class="progress-container">
                                        <div class="progress-bar completed" style="width: 100%;"></div>
                                        <span class="progress-text">100%</span>
                                    </div>
                                </div>
                                <div class="project-stats">
                                    <div class="stat">
                                        <i class="fas fa-check-circle"></i>
                                        <span>Completado</span>
                                    </div>
                                    <div class="stat">
                                        <i class="fas fa-award"></i>
                                        <span>Entregado</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="project-actions">
                                <a href="#" class="btn-outline">Ver Renders</a>
                                <a href="#" class="btn-outline">Documentación</a>
                                <a href="#" class="btn-primary-sm">Ver Detalles</a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Actividad Reciente -->
            <section class="activity-section">
                <div class="section-header">
                    <div class="section-title">
                        <h2><i class="fas fa-history"></i> Actividad Reciente</h2>
                        <p class="section-subtitle">Últimas acciones en tus proyectos</p>
                    </div>
                </div>
                
                <div class="activity-timeline">
                    <div class="activity-item">
                        <div class="activity-icon"><i class="fas fa-upload"></i></div>
                        <div class="activity-content">
                            <h4>Planos estructurales actualizados</h4>
                            <p>Torre Central - Revisión de cimentación y estructura</p>
                            <span class="activity-time">hace 2 horas</span>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon"><i class="fas fa-check"></i></div>
                        <div class="activity-content">
                            <h4>Especificaciones técnicas aprobadas</h4>
                            <p>Remodelación Oficinas - Cliente confirmó materiales</p>
                            <span class="activity-time">hace 5 horas</span>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon"><i class="fas fa-comments"></i></div>
                        <div class="activity-content">
                            <h4>Reunión de seguimiento completada</h4>
                            <p>Torre Central - Revisión de avances con equipo</p>
                            <span class="activity-time">ayer</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Sidebar con tareas y documentos -->
        <aside class="sidebar">
            <!-- Tareas Pendientes -->
            <section class="sidebar-section">
                <div class="sidebar-header">
                    <h3><i class="fas fa-tasks"></i> Tareas Pendientes</h3>
                    <a href="#" class="btn-icon"><i class="fas fa-plus"></i></a>
                </div>
                
                <div class="task-list">
                    {% if tasks %}
                        {% for task in tasks|slice:":5" %}
                        <div class="task-item {% if task.completed %}completed{% endif %}">
                            <div class="task-checkbox"></div>
                            <div class="task-content">
                                <h4 class="task-title">{{ task.title }}</h4>
                                {% if task.project %}
                                <p class="task-project">{{ task.project }}</p>
                                {% endif %}
                                {% if task.due_date %}
                                <span class="task-due">{{ task.due_date|date:"d M" }}</span>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                    <div class="task-item high-priority">
                        <div class="task-checkbox"></div>
                        <div class="task-content">
                            <h4 class="task-title">Revisar planos estructurales</h4>
                            <p class="task-project">Torre Central</p>
                            <span class="task-due">Hoy</span>
                        </div>
                    </div>
                    <div class="task-item completed">
                        <div class="task-checkbox"></div>
                        <div class="task-content">
                            <h4 class="task-title">Aprobar especificaciones eléctricas</h4>
                            <p class="task-project">Remodelación Oficinas</p>
                        </div>
                    </div>
                    <div class="task-item">
                        <div class="task-checkbox"></div>
                        <div class="task-content">
                            <h4 class="task-title">Preparar presentación cliente</h4>
                            <p class="task-project">Torre Central</p>
                            <span class="task-due">Mañana</span>
                        </div>
                    </div>
                    <div class="task-item">
                        <div class="task-checkbox"></div>
                        <div class="task-content">
                            <h4 class="task-title">Actualizar presupuesto materiales</h4>
                            <p class="task-project">Remodelación Oficinas</p>
                            <span class="task-due">2 días</span>
                        </div>
                    </div>
                    <div class="task-item">
                        <div class="task-checkbox"></div>
                        <div class="task-content">
                            <h4 class="task-title">Coordinar con ingenieros</h4>
                            <p class="task-project">Torre Central</p>
                            <span class="task-due">Próxima semana</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                <a href="#" class="view-all-link">Ver todas las tareas</a>
            </section>

            <!-- Documentos Recientes -->
            <section class="sidebar-section">
                <div class="sidebar-header">
                    <h3><i class="fas fa-folder-open"></i> Documentos Técnicos</h3>
                    <a href="#" class="btn-icon"><i class="fas fa-upload"></i></a>
                </div>
                
                <div class="document-list">
                    <div class="document-item">
                        <div class="document-icon pdf">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="document-content">
                            <h4 class="document-name">Especificaciones Técnicas.pdf</h4>
                            <p class="document-details">Torre Central • 2.3 MB</p>
                            <span class="document-time">hace 2h</span>
                        </div>
                    </div>
                    
                    <div class="document-item">
                        <div class="document-icon excel">
                            <i class="fas fa-file-excel"></i>
                        </div>
                        <div class="document-content">
                            <h4 class="document-name">Presupuesto Final.xlsx</h4>
                            <p class="document-details">Remodelación Oficinas • 1.8 MB</p>
                            <span class="document-time">hace 5h</span>
                        </div>
                    </div>
                    
                    <div class="document-item">
                        <div class="document-icon word">
                            <i class="fas fa-file-word"></i>
                        </div>
                        <div class="document-content">
                            <h4 class="document-name">Acta de Reunión.docx</h4>
                            <p class="document-details">Torre Central • 456 KB</p>
                            <span class="document-time">ayer</span>
                        </div>
                    </div>
                    
                    <div class="document-item">
                        <div class="document-icon image">
                            <i class="fas fa-file-image"></i>
                        </div>
                        <div class="document-content">
                            <h4 class="document-name">Renders Fachada.jpg</h4>
                            <p class="document-details">Torre Central • 4.2 MB</p>
                            <span class="document-time">ayer</span>
                        </div>
                    </div>
                    
                    <div class="document-item">
                        <div class="document-icon pdf">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="document-content">
                            <h4 class="document-name">Planos Arquitectónicos.pdf</h4>
                            <p class="document-details">Remodelación Oficinas • 15.7 MB</p>
                            <span class="document-time">hace 2d</span>
                        </div>
                    </div>
                </div>
                
                <a href="#" class="view-all-link">Ver todos los documentos</a>
            </section>
        </aside>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/dashboard.js' %}?v=4"></script>
{% endblock %} 