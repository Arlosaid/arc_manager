<!-- templates/includes/sidebar.html -->
<div class="sidebar" id="sidebar">
    <!-- Toggle button for mobile -->
    <button class="sidebar-toggle d-md-none" id="sidebarToggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar Content -->
    <div class="sidebar-content">
        <!-- Logo/Brand Section -->
        <div class="sidebar-brand">
            <div class="brand-logo">
                <i class="fas fa-layer-group"></i>
            </div>
            <h5 class="brand-text">Arc Manager</h5>
        </div>

        <!-- Main Navigation -->
        <nav class="sidebar-nav">
            <!-- Dashboard Section -->
            <div class="nav-section">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a class="nav-link {% if request.path == '/dashboard/' %}active{% endif %}" href="#" data-tooltip="Dashboard">
                            <div class="nav-icon">
                                <i class="fas fa-home"></i>
                            </div>
                            <span class="nav-text">Dashboard</span>
                            <div class="nav-indicator"></div>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Plans Section - Para todos los usuarios -->
            <div class="nav-section">
                <div class="section-header">
                    <h6 class="section-title">
                        <i class="fas fa-box"></i>
                        <span>Planes y Suscripciones</span>
                    </h6>
                </div>
                <ul class="nav-list">
                    <!-- Para usuarios autenticados -->
                    {% if user.is_authenticated %}
                        <li class="nav-item">
                            <a class="nav-link {% if '/plans/dashboard/' in request.path %}active{% endif %}" 
                               href="{% url 'plans:subscription_dashboard' %}" data-tooltip="Mi Suscripción">
                                <div class="nav-icon">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <span class="nav-text">Mi Suscripción</span>
                                <div class="nav-indicator"></div>
                            </a>
                        </li>
                        
                        <!-- Para admin de organización -->
                        {% if user.is_org_admin and not user.is_superuser %}
                            <li class="nav-item">
                                <a class="nav-link {% if '/plans/manage/' in request.path %}active{% endif %}" 
                                   href="{% url 'plans:org_management' %}" data-tooltip="Gestión de Plan">
                                    <div class="nav-icon">
                                        <i class="fas fa-cogs"></i>
                                    </div>
                                    <span class="nav-text">Gestión de Plan</span>
                                    <div class="nav-indicator"></div>
                                </a>
                            </li>
                        {% endif %}
                        
                        <!-- Para superusuarios -->
                        {% if user.is_superuser %}
                            <li class="nav-item">
                                <a class="nav-link {% if '/plans/admin/subscriptions/' in request.path %}active{% endif %}" 
                                   href="{% url 'plans:superuser_subscription_management' %}" data-tooltip="Gestión de Suscripciones">
                                    <div class="nav-icon">
                                        <i class="fas fa-tachometer-alt"></i>
                                    </div>
                                    <span class="nav-text">Panel de Suscripciones</span>
                                    <div class="nav-indicator"></div>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link {% if '/plans/admin/' in request.path and '/subscriptions/' not in request.path %}active{% endif %}" 
                                   href="{% url 'plans:superuser_list' %}" data-tooltip="Gestión de Planes">
                                    <div class="nav-icon">
                                        <i class="fas fa-layer-group"></i>
                                    </div>
                                    <span class="nav-text">Gestión de Planes</span>
                                    <div class="nav-indicator"></div>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link {% if '/plans/admin/payments/manual/' in request.path %}active{% endif %}" 
                                   href="{% url 'plans:manual_payment' %}" data-tooltip="Pagos Manuales">
                                    <div class="nav-icon">
                                        <i class="fas fa-money-bill-wave"></i>
                                    </div>
                                    <span class="nav-text">Pagos Manuales</span>
                                    <div class="nav-indicator"></div>
                                </a>
                            </li>
                        {% endif %}
                        
                        <li class="nav-item">
                            <a class="nav-link {% if '/plans/upgrade/' in request.path %}active{% endif %}" 
                               href="{% url 'plans:upgrade_plan' %}" data-tooltip="Actualizar Plan">
                                <div class="nav-icon">
                                    <i class="fas fa-arrow-up"></i>
                                </div>
                                <span class="nav-text">Actualizar Plan</span>
                                <div class="nav-indicator"></div>
                            </a>
                        </li>
                    {% endif %}
                    
                    <!-- Para todos (públicos) -->
                    <li class="nav-item">
                        <a class="nav-link {% if '/plans/pricing/' in request.path %}active{% endif %}" 
                           href="{% url 'plans:pricing' %}" data-tooltip="Precios y Planes">
                            <div class="nav-icon">
                                <i class="fas fa-tags"></i>
                            </div>
                            <span class="nav-text">Precios y Planes</span>
                            <div class="nav-indicator"></div>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Administration Section -->
            {% if user.is_superuser or user.is_org_admin %}
                <div class="nav-section">
                    <div class="section-header">
                        <h6 class="section-title">
                            <i class="fas fa-cogs"></i>
                            <span>Administración</span>
                        </h6>
                    </div>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a class="nav-link {% if 'users' in request.path %}active{% endif %}" 
                               href="{% url 'users:list' %}" data-tooltip="Usuarios">
                                <div class="nav-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <span class="nav-text">Usuarios</span>
                                <div class="nav-indicator"></div>
                            </a>
                        </li>
                        
                        {% if user.is_superuser %}
                            <li class="nav-item">
                                <a class="nav-link {% if 'organizaciones' in request.path %}active{% endif %}" 
                                   href="{% url 'orgs:list' %}" data-tooltip="Organizaciones">
                                    <div class="nav-icon">
                                        <i class="fas fa-building"></i>
                                    </div>
                                    <span class="nav-text">Organizaciones</span>
                                    <div class="nav-indicator"></div>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/admin/" data-tooltip="Panel de Administración Django">
                                    <div class="nav-icon">
                                        <i class="fas fa-database"></i>
                                    </div>
                                    <span class="nav-text">Admin Django</span>
                                    <div class="nav-indicator"></div>
                                </a>
                            </li>
                        {% elif user.is_org_admin and user.organization %}
                            <li class="nav-item">
                                <a class="nav-link {% if 'organizaciones' in request.path %}active{% endif %}" 
                                   href="{% url 'orgs:detail' user.organization.pk %}" data-tooltip="Mi Organización">
                                    <div class="nav-icon">
                                        <i class="fas fa-building"></i>
                                    </div>
                                    <span class="nav-text">Mi Organización</span>
                                    <div class="nav-indicator"></div>
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
            {% endif %}
        </nav>
    </div>
    
    <!-- Sidebar Overlay for mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
</div>